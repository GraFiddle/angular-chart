!function(){"use strict";var a=window.angular?window.angular:"undefined"!=typeof require?require("angular"):void 0,b=a.module("angularCircularNavigation",[]).directive("circular",["$compile",function(){return{restrict:"EA",scope:{options:"="},template:'<div class="cn-wrapper {{options.size}} items-{{options.items.length}}" ng-class="{\'opened-nav\': options.isOpen}"><ul><li ng-repeat="item in options.items"><a ng-hide="item.empty" ng-click="perform(options, item)" ng-class="{\'is-active\': item.isActive}" class="{{item.cssClass}}" title="{{item.title}}" style="background: {{item.background ? item.background : options.background}}; color: {{item.color ? item.color : options.color}};"><span>{{item.content}}</span></a></li></ul></div><button ng-click="toggleMenu()" class="cn-button {{options.button.size}}" ng-class="options.button.cssClass" style="background: {{options.button.background ? options.button.background : options.background}}; color: {{options.button.color ? options.button.color :options.color}};">{{options.content}}</button>',controller:["$scope","$element","$attrs",function(a){a.toggleMenu=function(){a.options.isOpen=!a.options.isOpen},a.perform=function(b,c){"function"==typeof c.onclick&&c.onclick(b,c),a.options.toggleOnClick&&a.toggleMenu()}}]}}]);"function"==typeof define&&define.amd?define("circular",["angular"],b):"undefined"!=typeof exports&&"undefined"!=typeof module&&(module.exports=b)}(),function(){"use strict";var a=window.angular?window.angular:"undefined"!=typeof require?require("angular"):void 0,b=a.module("angularChart",["angularCircularNavigation"]).directive("angularchart",["$compile",function(b){{var c=window.c3?window.c3:"undefined"!=typeof require?require("c3"):void 0;window.d3?window.d3:"undefined"!=typeof require?require("d3"):void 0}return{restrict:"EA",scope:{dataset:"=",options:"=",schema:"="},link:function(d,e){d.options=d.options?d.options:{},d.chart=null,d.configuration={data:{x:"",keys:{value:[],x:""},types:{},names:[],colors:{},selection:{},groups:[],axes:{},onselected:function(a){d.selections.addSelected(a)},onunselected:function(a){d.selections.removeSelected(a)},onclick:a.noop},axis:{x:{label:"",tick:{}},y:{label:"",min:null,max:null,tick:{}},y2:{label:"",min:null,max:null,tick:{}}},tooltip:{format:{}},legend:{show:!0},subchart:{show:!1},zoom:{enabled:!1},grid:{x:{lines:[]},y:{lines:[]}}},d.addIdentifier=function(){d.dataAttributeChartID="chartid"+Math.floor(1000000001*Math.random()),a.element(e).attr("id",d.dataAttributeChartID),d.configuration.bindto="#"+d.dataAttributeChartID},d.updateOptions=function(a){d.disableOptionsWatcher=!0,d.$apply(a),d.disableOptionsWatcher=!1},d.updateChart=function(){if(delete d.configuration.data.columns,delete d.configuration.data.rows,delete d.configuration.data.json,!d.dataset)throw"No data provided. The dataset has to be an array with the records.";if(d.options.data&&"columns"===d.options.data.orientation?d.configuration.data.columns=d.dataset:d.options.data&&"rows"===d.options.data.orientation?d.configuration.data.rows=d.dataset:d.configuration.data.json=d.dataset,d.configuration.data.type=d.options.type,d.configuration.axis.y.show=!1,d.configuration.axis.y2.show=!1,d.configuration.data.keys.value=[],d.options.rows&&d.options.rows.forEach(function(a){(void 0===a.show||a.show)&&d.configuration.data.keys.value.push(a.key),a.name?d.configuration.data.names[a.key]=a.name:d.schema&&d.schema[a.key]&&d.schema[a.key].name&&(d.configuration.data.names[a.key]=d.schema[a.key].name),a.type||(a.type=d.options.type),d.configuration.data.types[a.key]=a.type,a.color&&(d.configuration.data.colors[a.key]=a.color),a.axis&&(d.configuration.data.axes[a.key]=a.axis,d.configuration.axis[a.axis].show=!0)}),d.options.selection&&d.options.selection.enabled&&(d.configuration.data.selection.enabled=d.options.selection.enabled,d.configuration.data.selection.multiple=d.options.selection.multiple),d.options.xAxis&&d.options.xAxis.key&&d.configuration.data.keys.x&&d.configuration.data.keys.x!==d.options.xAxis.key&&(d.options.selection.selected=[]),d.configuration.data.keys.x="",d.configuration.axis.x.type="category",d.configuration.axis.x.tick.format=void 0,d.options.xAxis&&d.options.xAxis.key&&(d.configuration.data.keys.x=d.options.xAxis.key,d.configuration.data.x=d.options.xAxis.key,d.options.xAxis.displayFormat&&(d.configuration.axis.x.tick.format=d.options.xAxis.displayFormat),d.schema&&d.schema[d.options.xAxis.key])){var b=d.schema[d.options.xAxis.key];(b.prefix||b.postfix)&&(d.configuration.axis.x.tick.format=function(a){return b.prefix&&(a=b.prefix+" "+a),b.postfix&&(a+=b.postfix),a}),b.type&&"datetime"===b.type?(d.configuration.axis.x.type="timeseries",d.configuration.data.xFormat=b.format?b.format:"%Y-%m-%dT%H:%M:%S"):"numeric"===b.type&&(d.configuration.axis.x.type="numeric")}d.configuration.axis.x.label=d.options.xAxis&&d.options.xAxis.label?d.options.xAxis.label:"",d.configuration.data.groups=d.options.groups?d.options.groups:[],d.configuration.data.onclick=d.options.onclick?d.options.onclick:a.noop,d.configuration.subchart.show=d.options.subchart?d.options.subchart.show:!1,a.isObject(d.options.yAxis)&&(d.configuration.axis.y.label=a.isUndefined(d.options.yAxis.label)?"":d.options.yAxis.label,d.configuration.axis.y.max=a.isUndefined(d.options.yAxis.max)?null:d.options.yAxis.max,d.configuration.axis.y.min=a.isUndefined(d.options.yAxis.min)?null:d.options.yAxis.min,d.configuration.axis.y.tick.format=a.isUndefined(d.options.yAxis.displayFormat)?null:d.options.yAxis.displayFormat),a.isObject(d.options.y2Axis)&&(d.configuration.axis.y2.label=a.isUndefined(d.options.y2Axis.label)?"":d.options.y2Axis.label,d.configuration.axis.y2.max=a.isUndefined(d.options.y2Axis.max)?null:d.options.y2Axis.max,d.configuration.axis.y2.min=a.isUndefined(d.options.y2Axis.min)?null:d.options.y2Axis.min,d.configuration.axis.y2.tick.format=a.isUndefined(d.options.y2Axis.displayFormat)?null:d.options.y2Axis.displayFormat),d.configuration.tooltip.format={},d.options.tooltip&&d.options.tooltip.displayFormat&&(d.configuration.tooltip.format.value=d.options.tooltip.displayFormat),d.configuration.legend.show=d.options.legend?void 0===d.options.legend.selector?d.options.legend.show:!d.options.legend.selector:!0,d.configuration.grid.y.lines=[],d.configuration.grid.x.lines=[],d.options.annotation&&d.options.annotation.forEach(function(a){switch(a.axis){case"x":d.configuration.grid.x.lines.push({text:a.label,value:a.value});break;case"y":d.configuration.grid.y.lines.push({text:a.label,value:a.value});break;case"y2":d.configuration.grid.y.lines.push({text:a.label,value:a.value,axis:"y2"})}}),d.configuration.size=d.options.size?d.options.size:{},d.options.zoom&&(d.configuration.zoom.enabled=d.options.zoom.enabled),d.configuration.zoom.onzoomend=function(a){d.updateOptions(function(){d.options.zoom.range=a}),d.options.zoom.onzoom&&d.options.zoom.onzoom()},d.configuration.subchart.onbrush=function(a){d.updateOptions(function(){d.options.zoom.range=a}),d.options.zoom.onzoom&&d.options.zoom.onzoom()},d.options.donut&&(d.configuration.donut=d.options.donut),window.onresize=null,d.chart=c.generate(d.configuration),d.chooseXAxis(),d.customLegend(),d.chooseChartType(),d.toggleSubchartLink(),a.element(e).removeAttr("style"),d.options.zoom&&d.options.zoom.range&&d.chart.zoom(d.options.zoom.range)},d.chooseXAxis=function(){if("pie"!==d.options.type&&"donut"!==d.options.type&&d.options.xAxis&&d.options.xAxis.selector){var c=a.element('<span class="chooseXAxis"/>');c.append('<select ng-hide="options.type === \'pie\' || options.type === \'donut\'" ng-model="options.xAxis.key" class="form-control"><option ng-repeat="col in schema" value="{{col.id}}" ng-selected="col.id===options.xAxis.key">{{col.name ? col.name : col.id}}</option></select>'),b(c)(d),e.append(c)}},d.chooseChartType=function(){if(d.options.typeSelector){var c=a.element('<div class="chooseChartType btn-group">');c.append("<button ng-click=\"changeChartType('scatter')\" ng-class=\"{'active': options.type === 'scatter'}\" class=\"btn btn-default\">Scatter</button>"),c.append("<button ng-click=\"changeChartType('bar')\" ng-class=\"{'active': options.type === 'bar'}\" class=\"btn btn-default\">Bar</button>"),c.append("<button ng-click=\"changeChartType('line')\" ng-class=\"{'active': options.type === 'line'}\" class=\"btn btn-default\">Line</button>"),c.append("<button ng-click=\"changeChartType('pie')\" ng-class=\"{'active': options.type === 'pie'}\" class=\"btn btn-default\">Pie</button>"),b(c)(d),e.prepend(c)}},d.changeChartType=function(a){d.options.type=a,d.options.rows.forEach(function(b){b.type=a})},d.toggleSubchart=function(){d.options.subchart.show=!d.options.subchart.show,d.options.zoom&&d.options.zoom.range&&delete d.options.zoom.range},d.toggleSubchartLink=function(){if("pie"!==d.options.type&&"donut"!==d.options.type&&d.options.subchart&&d.options.subchart.selector){var c=a.element('<span class="toggleSubchart"/>');c.append(d.options.subchart.show?'<a title="hide navigation subchart" ng-click="toggleSubchart()"><i class="flaticon-hide"></i> hide navigator</a>':'<a title="show navigation subchart" ng-click="toggleSubchart()"><i class="flaticon-show"></i> show navigator</a>'),b(c)(d),e.append(c)}},d.customLegend=function(){if(d.options.legend&&d.options.legend.selector){var c=a.element('<div class="customLegend"><span ng-repeat="row in options.rows" ng-if="row.key !== options.xAxis.key" class="customLegend-item" ><circular options="rowEdit[$index]"></circular><span class="customLegend-label" data-id="{{row.name}}">{{(schema[row.key] && schema[row.key].name) ? schema[row.key].name : (row.name ? row.name : row.key)}}</span></span></div>');b(c)(d),e.prepend(c);var f={line:"flaticon-line",spline:"flaticon-line",area:"flaticon-area","area-spline":"flaticon-area",scatter:"flaticon-scatter",bar:"flaticon-bar",pie:"flaticon-pie",donut:"flaticon-pie",step:"flaticon-line","area-step":"flaticon-area"};d.switchAxis=function(a,b){d.options.rows[a.index].axis=b.axis,d.options.rows[a.index].show=!0},d.switchType=function(a,b){d.options.rows[a.index].type=b.type,d.options.rows[a.index].show=!0},d.switchShow=function(a,b){d.options.rows[a.index].show=b.show},d.rowEdit=[];for(var g in d.options.rows)if(!d.options.xAxis||d.options.xAxis.key!==d.options.rows[g].key){var h=void 0===d.options.rows[g].show||d.options.rows[g].show===!0;d.rowEdit[g]={row:"sales",index:g,isOpen:!1,toggleOnClick:!0,background:h?d.options.rows[g].color:"gray",color:"white",size:"",button:{content:"",cssClass:f[d.options.rows[g].type],background:h?d.options.rows[g].color:"gray",color:"white",size:"small"},items:[{title:"plot data on right axis",axis:"y2",onclick:d.switchAxis,isActive:"y2"===d.options.rows[g].axis,cssClass:"flaticon-right"},{title:"plot data on left axis",axis:"y",onclick:d.switchAxis,isActive:"y"===d.options.rows[g].axis,cssClass:"flaticon-left"},{empty:!0},{title:"display data as line chart",type:"spline",onclick:d.switchType,isActive:"spline"===d.options.rows[g].type||"line"===d.options.rows[g].type,cssClass:f.spline},{title:"display data as area chart",type:"area-spline",onclick:d.switchType,isActive:"area"===d.options.rows[g].type||"area-spline"===d.options.rows[g].type,cssClass:f["area-spline"]},{title:"display data as bar chart",type:"bar",onclick:d.switchType,isActive:"bar"===d.options.rows[g].type,cssClass:f.bar},{title:"display data as scatter plot",type:"scatter",onclick:d.switchType,isActive:"scatter"===d.options.rows[g].type,cssClass:f.scatter},{empty:!0},{title:"show this data",show:!0,onclick:d.switchShow,isActive:h,cssClass:"flaticon-show"},{title:"hide this data",show:!1,onclick:d.switchShow,isActive:!h,cssClass:"flaticon-hide"}]}}}},d.selections={avoidSelections:!1,addSelected:function(a){this.avoidSelections||(d.$apply(d.options.selection.selected.push(a)),d.options.selection.onselected&&d.options.selection.onselected())},removeSelected:function(a){this.avoidSelections||(d.$apply(d.options.selection.selected=d.options.selection.selected.filter(function(b){return b.id!==a.id||b.index!==a.index})),d.options.selection.onunselected&&d.options.selection.onunselected())},performSelections:function(a){this.avoidSelections=!0,a.forEach(function(a){d.chart.select([a.id],[a.index])}),this.avoidSelections=!1},performUnselections:function(a){this.avoidSelections=!0,a.forEach(function(a){d.chart.unselect([a.id],[a.index])}),this.avoidSelections=!1},watchOptions:function(a,b){var c=b.selection&&b.selection.selected?b.selection.selected:[],d=a.selection&&a.selection.selected?a.selection.selected:[],e=d.filter(function(a){var b=!0;return c.forEach(function(c){return c.id===a.id&&c.index===a.index?void(b=!1):void 0}),b}),f=c.filter(function(a){var b=!0;return d.forEach(function(c){return c.id===a.id&&c.index===a.index?void(b=!1):void 0}),b}),g=!1;return e.length>0&&(this.performSelections(e),g=!0),f.length>0&&(this.performUnselections(f),g=!0),g}},d.startOptionsWatcher=function(){d.$watch("options",function(a,b){d.disableOptionsWatcher||d.selections.watchOptions(a,b)||(b.type!==a.type&&(d.chart.transform(a.type),["pie","donut"].indexOf(a.type)>=0&&d.options.rows.forEach(function(a){delete a.type})),d.updateChart())},!0)},d.smallWatcher=void 0,d.bigWatcher=void 0,d.startSmallDatasetWatcher=function(){return d.$watchCollection("dataset",function(b,c){a.equals(b,c)||(d.updateChart(),d.startDatasetWatcher())})},d.startBigDatasetWatcher=function(){return d.$watch(function(){return d.dataset.length},function(b,c){a.equals(b,c)||(d.updateChart(),d.startDatasetWatcher())})},d.startDatasetWatcher=function(){var a=d.options.data&&d.options.data.watchLimit?d.options.data.watchLimit:100;d.dataset.length<a?(d.smallWatcher||(d.smallWatcher=d.startSmallDatasetWatcher()),d.bigWatcher&&(d.bigWatcher(),d.bigWatcher=void 0)):(d.bigWatcher||(d.bigWatcher=d.startBigDatasetWatcher()),d.smallWatcher&&(d.smallWatcher(),d.smallWatcher=void 0))},d.registerDestroyListener=function(){d.$on("$destroy",function(){d.chart.destroy(),e.remove()})},d.addIdentifier(),d.options.selection&&d.selections.performSelections(d.options.selection.selected),d.startOptionsWatcher(),d.startDatasetWatcher(),d.registerDestroyListener()}}}]);"function"==typeof define&&define.amd?define("angularChart",["c3","angular"],b):"undefined"!=typeof exports&&"undefined"!=typeof module&&(module.exports=b)}();